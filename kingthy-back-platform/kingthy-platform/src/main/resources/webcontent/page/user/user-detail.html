<!DOCTYPE HTML>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />



	<link rel="stylesheet" type="text/css" href="../../css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="../../css/plugins/sweetalert/sweetalert.css">
	<link rel="stylesheet" type="text/css" href="../../plugins/cityPicker/css/cityPicker.css">
	<link rel="stylesheet" type="text/css" href="../../plugins/clockpicker/dist/bootstrap-clockpicker.min.css">


	<title>体验店-详情</title>
	<style>
		.ul-img-list {
			list-style: none;
			margin: 0;
			padding: 0;
		}

		.ul-img-list li {
			float: left;
			margin-right: 10px
		}

		.box-container {
			color: #838383;
			font-size: 12px;
			margin-top: 15px;
			background-color: #FFF;
			border: solid 1px #ddd;
			padding: 0;
		}

		.box-container .queueList {
			margin: 20px;
		}

		.box-container .statusBar {
			height: 50px;
			border-top: 1px solid #dadada;
			padding: 0 20px;
			vertical-align: middle;
			position: relative;
		}

		.help-block {
			display: inline-block;
			margin-top: 5px;
			margin-bottom: auto;
		}
	</style>
</head>

<body>




	<div id="app" style="margin-top:30px;margin-left:20px">


		<form class=" form-horizontal center-block" id="myform" name="myform">
			<div class="row">

				<div class="col-xs-4">
					<div class="form-group">
						<label class="col-sm-3 control-label">注册时间:</label>
						<div class="col-sm-9">
							<label class="control-label">2017-8-11</label>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">最近登录:</label>
						<div class="col-sm-9">
							<label class="control-label">2017-8-11</label>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">用户名:</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" value="" id="userName" name="userName" v-model="model.userName" placeholder="" readonly/>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label"><span style="color:red">*</span>手机号:</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" value="" id="phone" name="phone" v-model="model.phone" placeholder="" readonly/>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">性别:</label>
						<div class="col-sm-9">
							<lable class="radio-inline">
								<input type="radio" id="status-1" name="status" value="1" checked v-model="model.gender" disabled/>
								<label for="status-1">男</label>
							</lable>
							<lable class="radio-inline">
								<input type="radio" id="status-0" name="status" value="0" v-model="model.gender"  disabled/>
								<label for="status-0">女</label>
							</lable>

						</div>
					</div>
				</div>

				<div class="col-xs-7">

					<div class="col-xs-3">
						<div>
							<img style="height:200px;width:200px" :src="model.headImage"></img>
							<p style="text-align:center;width:200px">头像</p>
						</div>
					</div>

					<div class="col-xs-3">
						<div id="qrcode" style="height:200px;width:200px">
						</div>
						<p style="text-align:center;width:200px">二维码</p>
					</div>

				</div>
			</div>

			<div class="row">
				<div class="col-xs-12">
					<div class="form-group">
						<label class="col-sm-1 control-label">出生日期:</label>
						<div class="col-sm-2">
							<input type="text" id="birth" name="birth" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'birth\')||\'%y-%M-%d\'}' })" 
							class="form-control Wdate" v-model="model.birth" readonly>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">工作:</label>
						<div class="col-sm-2">
							<select id="occupation" name="occupation" class="form-control" v-model="model.occupation" disabled>
								<template v-for="item in baseData">
                                    <option v-if="item.type==0"  :value="item.id">{{item.className}}</option>
								</template>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">发型:</label>
						<div class="col-sm-2">
							<select id="face" name="face" class="form-control" v-model="model.face" disabled>
								<template v-for="item in baseData">
                                    <option v-if="item.type==1"  :value="item.id">{{item.className}}</option>
								</template>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">肤色:</label>
						<div class="col-sm-2">
							<select id="skinColor" name="skinColor" class="form-control" v-model="model.skinColor" disabled>
								<template v-for="item in baseData">
                                    <option v-if="item.type==2"  :value="item.id">{{item.className}}</option>
								</template>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">喜好风格:</label>
						<div class="col-sm-2">
							<select id="style" name="style" class="form-control" v-model="model.style" disabled>
								<template v-for="item in baseData">
                                    <option v-if="item.type==9"  :value="item.id">{{item.className}}</option>
								</template>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">收货地址:</label>
						<div class="col-sm-2 ">
							<select id="province" name="province" placeholder="省份" class="form-control" v-model="model.province" @change="areaChange(1)" disabled>
								<option v-for="item in provinceData" :value="item.id">{{item.name}}</option>
							</select>
						</div>
						<div class="col-sm-2 ">
							<select id="city" name="city" placeholder="城市" class="form-control" v-model="model.city" @change="areaChange(2)" disabled>
								<option v-for="item in cityData" :value="item.id">{{item.name}}</option>
							</select>
						</div>
						<div class="col-sm-2 ">
							<select id="district" name="district" placeholder="区/县" class="form-control" v-model="model.areaIds" @change="areaChange(3)" disabled>
							    <option v-for="item in districtData" :value="item.id">{{item.name}}</option>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label"></label>
						<div class="col-sm-4">
							<input type="text" class="form-control" value="" id="address" name="address" v-model="model.address" placeholder="详细地址"readonly />
						</div>
					</div>

					<div class="form-group">
						<label class="col-sm-1 control-label">邮编：</label>
						<div class="col-sm-2">
							<input type="text" class="form-control" value="" id="zipCode" name="zipCode" v-model="model.zipCode" placeholder="" readonly/>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">个性签名：</label>
						<div class="col-sm-4">
							<textarea name="description" v-model="model.signature" class="form-control" cols="" rows="5" placeholder="说点什么...255个字符以内"
							 dragonfly="true" readonly></textarea>
						</div>
					</div>
				</div>
			</div>
			<!--<div class="form-group">
						<div class="col-sm-offset-2 col-sm-10">
							<button type="button" class="btn btn-primary" @click="onSubmit">提交</button>
						</div>
					</div>-->

		</form>


	</div>




	<script type="text/javascript" src="../../js/jquery.min.js?v=2.1.4"></script>
	<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
	<script type="text/javascript" src="../../plugins/sweetalert/sweetalert.min.js"></script>
	<script type="text/javascript" src="../../plugins/layer/2.4/layer.js"></script>
	<script type="text/javascript" src="../../js/common.js"></script>
	<script type="text/javascript" src="../../js/vue.min.js"></script>
	<script type="text/javascript" src="../../js/axios.min.js"></script>
	<script type="text/javascript" src="../../js/axios-config.js"></script>
	<script type="text/javascript" src="../../plugins/jquery.validation/jquery.validate.js"></script>
	<script type="text/javascript" src="../../plugins/jquery.validation/jquery.validate-default.js"></script>
	<script type="text/javascript" src="../../plugins/My97DatePicker/4.8/WdatePicker.js"></script>
	<script type="text/javascript" src="../../js/jquery.qrcode.min.js"></script>

	<script type="text/javascript">

	</script>

	<script type="text/javascript">
		var parmObj = getLocalUrlParms();
		//定义数据保存执行的url
		var url = zmme + "/shop/create";
		//定义数据保存行的url请求方式POST：新增，PUT:修改
		var method = "POST";


		//Vue操作
		var vm = new Vue({
			el: '#app',
			//数据
			data: {
				//定义用于绑定的一个对象
				model: {},
				//cityData: [],//身份数据
				imageList: [],//图片数据
				provinceData: [],
				cityData: [],
				districtData: [],
				baseData: []
			},
			//加载页面时执行
			created: function () {

				//初始化部分参数值
				this.model = { status: true, address: "深圳市南山区高新南六路" };
				//如果是编辑，根据uuid加载数据
				if (parmObj.operate == "update") {
					//修改url为更新url,修改method为url对应的请求方式
					url = zmme + "/shop/update";
					method = "PUT";
					//获取编辑的数据并显示
					this.viewEditData();
				}
				this.getBaseData();
				this.getProvince();
			},
			//dom加载完成，需要操作dom的，可在mounted中操作。
			mounted: function () {
				let that = this

				//时间选择
				$('.clockpicker').clockpicker()
					.find('input').change(function (e) {
						var elId = e.target.id;
						console.log(elId);
						if (e.target.id == "openTime") {
							that.model.openTime = this.value;
						}
						if (e.target.id == "closeTime") {
							that.model.closeTime = this.value;
						}
					});
				//表单验证
				$("#myform").validate({
					rules: {
						name: "required",
					},
					messages: {
						name: "请输入名称",
					}
				});
			},
			//方法
			methods: {
				//根据UUID获取要编辑的数据
				viewEditData: function () {
					//根据uuid获取数据，并显示在页面
					axios.get(zmme + "/getInfo/" + parmObj.uuid).then(response => {
						var result = response.data;
						console.log(result);
						if (result.code == 0) {
							//绑定到对象
							this.model = result.data;
							//生成二维码
							$('#qrcode').qrcode({
								width:200,
								height: 200,
								text: this.model.uuid
							})
						} else {
							swal("错误！", result.message, "error");
						}
					})
				},
				//保存数据
				onSubmit: function () {
					//验证表单
					$("#myform").validate();
					//保存数据
					if ($("#myform").valid()) {
						var data = this.model;
						console.log(JSON.stringify(data));
						//通过验证    
						axios({
							method: method,
							url: url,
							data: data
						}).then(response => {
							var result = response.data;
							if (result.code == "0") {
								layer_close();
							} else {
								swal("错误！", result.message, "error");
							}
						});
					}
				},
				getBaseData: function () {

					var data = {

						"pageNum": 0,
						"pageSize": 10000

					};
					axios.post(zmme + "/baseData/query", data).then(response => {
						var result = response.data;
						if (result.code == 0) {
							//绑定到对象
							this.baseData = result.data.list;
						} else {
							swal("错误！", result.message, "error");
						}
					})
				},
				//获取地区数据
				getProvince: function () {
					var data = { grade: 0 };
					axios.post(zmme + "/area/queryAllArea", data).then(response => {
						var result = response.data;
						if (result.code == 0) {
							//绑定到对象
							this.provinceData = result.data;
						} else {
							swal("错误！", result.message, "error");
						}
					})
				},
				areaChange: function (grade) {

					var data = {
						"areaParentId": 0,
						"grade": grade
					}
					if (grade == 1) {
						//绑定到对象
						data.areaParentId = this.model.province;
					}
					if (grade == 2) {
						data.areaParentId = this.model.city;
					}
					if (grade == 3) {
						this.model.address = $("#province option:selected").text() + $("#city option:selected").text() + $("#district option:selected").text();
					} else {
						axios.post(zmme + "/area/queryAllArea", data).then(response => {
							var result = response.data;
							if (result.code == 0) {
								if (grade == 1) {
									//绑定到对象
									this.cityData = result.data;
								}
								if (grade == 2) {
									this.districtData = result.data;
								}
								this.model.areaName = $("#city option:selected").text();
								this.model.address = $("#province option:selected").text() + $("#city option:selected").text();
							} else {
								swal("错误！", result.message, "error");
							}
						})
					}

				},
				//添加图片
				addImages: function (e) {
					e.preventDefault();
					$('input[type=file]').trigger('click');
					return false;
				},
				//图片上传，显示
				onFileChange: function (e) {

					var files = e.target.files || e.dataTransfer.files;
					let param = new FormData(); //创建form对象
					for (var i in files) {
						param.append('file', files[i]);
					}
					$.ajax({
						type: 'post',
						url: fileServiceURL + "/fileUpload/stream",
						data: param,
						processData: false,
						contentType: false,
						dataType: 'json',
						mimeType: "multipart/form-data",
						success: function (res) {
							var imgUrls = res.data;
							for (var i in imgUrls) {
								var url = imgUrls[i];
								vm.imageList.push(url);
							}
						}
					});
					$('#fileUpload').val("");
				},
				//删除图片
				delImage: function (index) {
					this.imageList.splice(index, 1);
				}



			}

		});
		/*--------vue---end----------*/
	</script>

</body>

</html>
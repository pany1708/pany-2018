<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.kingthy.mapper.MessageInfoMapper" >
  <resultMap id="BaseResultMap" type="com.kingthy.entity.MessageInfo" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="uuid" property="uuid" jdbcType="CHAR" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="modify_date" property="modifyDate" jdbcType="TIMESTAMP" />
    <result column="del_flag" property="delFlag" jdbcType="BIT" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="modifier" property="modifier" jdbcType="VARCHAR" />
    <result column="version" property="version" jdbcType="INTEGER" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="content" property="content" jdbcType="VARCHAR" />
    <result column="url" property="url" jdbcType="VARCHAR" />
    <result column="push_time" property="pushTime" jdbcType="TIMESTAMP" />
    <result column="message_platform_uuid" property="messagePlatformUuid" jdbcType="CHAR" />
    <result column="members_uuid" property="membersUuid" jdbcType="CHAR" />
    <result column="member_name" property="memberName" jdbcType="VARCHAR" />
    <result column="push_target" property="pushTarget" jdbcType="CHAR" />
    <result column="push_status" property="pushStatus" jdbcType="BIT" />
  </resultMap>

  <select id="findListMessage" parameterType="com.kingthy.request.MessageInfoReq" resultType="com.kingthy.dto.MessageInfoDto">
    SELECT
    a.uuid,
    a.title,
    a.content,
    a.url,
    a.push_time pushTime,
    a.message_platform_uuid messagePlatformUuid,
    a.member_name memberName,
    a.push_target pushTarget,
    a.push_status pushStatus
    FROM
    message_info a
    WHERE a.del_flag = 0

    <if test="uuid != null and uuid != ''">
      AND a.uuid = #{uuid}
    </if>

    <if test="pushTarget != null">
      AND a.pushTarget = #{pushTarget}
    </if>

    <if test="beginTime != null">
      AND  unix_timestamp(a.push_time) * 1000 &gt;= #{beginTime}
    </if>

    <if test="endTime != null">
      AND  unix_timestamp(a.push_time) * 1000 &lt; #{endTime}
    </if>

    <if test="memberName != null and memberName != ''">
      AND a.member_name = #{memberName}

    </if>

    <if test="content != null and content != ''">
      AND a.content LIKE concat('%', #{content}, '%')

    </if>

  </select>

</mapper>
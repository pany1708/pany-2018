<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.kingthy.mapper.OperateAdvertisementMapper" >
  <resultMap id="BaseResultMap" type="com.kingthy.entity.OperateAdvertisement" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="uuid" property="uuid" jdbcType="CHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="modifier" property="modifier" jdbcType="VARCHAR" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="modify_date" property="modifyDate" jdbcType="TIMESTAMP" />
    <result column="del_flag" property="delFlag" jdbcType="BIT" />
    <result column="version" property="version" jdbcType="INTEGER" />
    <result column="status" property="status" jdbcType="BIT" />
    <result column="ad_name" property="adName" jdbcType="VARCHAR" />
    <result column="description" property="description" jdbcType="VARCHAR" />
    <result column="length" property="length" jdbcType="VARCHAR" />
    <result column="width" property="width" jdbcType="VARCHAR" />
    <result column="location" property="location" jdbcType="VARCHAR" />
    <result column="start_time" property="startTime" jdbcType="TIMESTAMP" />
    <result column="end_time" property="endTime" jdbcType="TIMESTAMP" />
    <result column="banners" property="banners" jdbcType="VARCHAR" />
    <result column="href" property="href" jdbcType="VARCHAR" />
  </resultMap>

  <select id="findByPage" resultMap="BaseResultMap" parameterType="com.kingthy.request.OperateAdvertisementReq">
    SELECT uuid,status,ad_name,description,length,width,location,start_time,end_time,banners,href
    FROM operate_advertisement
    WHERE del_flag is FALSE
    <if test="adName != null and adName!='' ">
      AND ad_name LIKE concat('%',#{adName},'%')
    </if>
    <if test="status != null">
      AND status = #{status.value}
    </if>
    <if test="description != null and description!='' ">
      AND description LIKE concat('%',#{description},'%')
    </if>
    <if test="startTime !=null">
      <![CDATA[ AND start_time  >=  #{startTime}  ]]>
    </if>
    <if test="endTime !=null "  >
      <![CDATA[ AND end_time <=  #{endTime}  ]]>
    </if>
    ORDER BY create_date DESC
  </select>

  <select id="findByPage_COUNT" resultType="Long">
    SELECT count(uuid)
    FROM operate_advertisement
    WHERE del_flag is FALSE
    <if test="adName != null and adName!='' ">
      AND ad_name LIKE concat('%',#{adName},'%')
    </if>
    <if test="status != null">
      AND status = #{status.value}
    </if>
    <if test="description != null and description!='' ">
      AND description LIKE concat('%',#{description},'%')
    </if>
    <if test="startTime !=null">
      <![CDATA[ AND start_time  >=  #{startTime}  ]]>
    </if>
    <if test="endTime !=null "  >
      <![CDATA[ AND end_time <=  #{endTime}  ]]>
    </if>
  </select>

  <select id="selectByUuid" parameterType="java.lang.String" resultMap="BaseResultMap">
    SELECT uuid,status,ad_name,description,length,width,location,start_time,end_time,banners,href,version
    FROM operate_advertisement
    WHERE del_flag is FALSE
    AND uuid = #{uuid}
  </select>
</mapper>